:javascript
  function createUploader(){

   var uploader = new qq.FileUploaderBasic({
       element: document.getElementById('file-upload'),
       params: {'photo' : {'is_avatar':false}},
       allowedExtensions: ['jpg', 'jpeg', 'png', 'gif'],
       action: "#{photos_path}",
       debug: true,
       button: document.getElementById('file-upload'),
       sizeLimit: 4194304,

       onProgress: function(id, fileName, loaded, total){
       },

       onSubmit: function(id, fileName){
        $('#file-upload').addClass("loading");
        $('.photo_form').closest( "form" ).find("input[type='submit']").attr('disabled','disabled');
        $(".photo_form").closest( "form" ).addClass("with_photos");
        $('#photozone').css( "height","60px" );
        $('#photozone').append(
          "<li class='photo loading' style='position:relative;'>" +
            "<img src='/images/ui/loading.gif' />" +
          "</li>"
          );
       },

       onComplete: function(id, fileName, responseJSON) {
        var id = responseJSON.data.photo.id,
            url = responseJSON.data.photo.thumb_small,
            currentPlaceholder = $('li.loading').first();

        $(".photo_form").closest( "form" ).addClass("with_photos");
        $('.photo_form').append("<input type='hidden' value='" + id + "' name='photos[]' />");

        var img = currentPlaceholder.find('img');
        img.attr('src', url);
        img.attr('data-id', id);
        currentPlaceholder.removeClass('loading');

        var form = $('.photo_form').closest( "form" );

        form.find("input[type='submit']").removeAttr('disabled');

       },

       onAllComplete: function(completed_files){
       }

   });
  }
    window.onload = createUploader;
