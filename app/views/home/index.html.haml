=content_for :head do
  = include_stylesheets :sepcial_pages_home_index, :media => 'all'
  = include_javascripts :scroll_page
  = include_javascripts :show_photo
  = include_javascripts :status_message
  = include_javascripts :mention
  = include_javascripts :google_map
  = javascript_include_tag "http://maps.google.com/maps/api/js?sensor=false"

.span-18.last.content_panel
  .home_container
    .nav_tab
      %ul
        %li
          =link_to "信息","/home/show_post",:remote => true,:id => 'post'
        %li
          =link_to "活动","/home/show_event",:remote => true,:id=>'event_info'
    .feed_toolbar
      %ul.event.hide
        %li
          =link_to "近期活动","/home/show_event",:remote => true,:id=>'recent_event'
        %li
          =link_to "我的活动","/home/show_my_event",:remote => true,:id => 'my_event'
        %li
          =link_to "朋友活动","/home/show_following_event",:remote => true,:id => 'following_event'
      .create_post
        = form_for(StatusMessage.new,:remote => true,:html => { :multipart => true }) do |status|
          = status.text_area :content,:class => 'content'
          = hidden_field_tag :contacts
          = label_tag 'weibo', '说点什么吧...', :class => 'placeholder'
          = hidden_field_tag :topic_id
          = status.submit "发布", :class => 'glass_button',"data-disable-with" => t("posting")
          .pic_upload_panel
            = render "status_messages/add_pic"
        
      .new_event.hide
        = render 'common/big_link_button', :content => '发起活动', :path => new_event_path 
      .post_type_bar
        %a{:class => 'title photo', :href => 'javascript:void(0)'} 
          %span.img
          %span.desc='图片'
        %a{:class => 'title topic', :href => 'javascript:void(0)'} 
          %span.img
          %span.desc='话题'
        %a{:class => 'title at_friend', :href => 'javascript:void(0)'} 
          %span.img
          %span.desc='好友'
        = render :partial => 'item_topics/new_topic_box', :locals => {:item_topic => @item_topic, :rtopics => @recent_topics} 
      .clear


    .events_panel
    .clear

#hide_area
  .topic_tag.hide
    = link_to '话题', 'javascript:void(0)', :class => 'topic_name' 
    = link_to 'x', 'javascript:void(0)', :class => 'close_topic_tag'
    
.span-6.last.right_bar
  = render 'people/person_list', :person => @person
:javascript
  $( ".nav_tab a" ).live( "click",function( ){
    $(".feed_toolbar").fadeTo(100, 0.4);
    $(".events_panel").fadeTo(100, 0.4);
    })
  $( ".feed_toolbar .event a" ).live( "click",function( ){
    $(".events_panel").fadeTo(100, 0.4);
    })

  $.get("/home/show_post");
  $('.create_post #status_message_content').focusin(function() {
    $(this).css('height', '40px'); 
    $("label.placeholder").hide();
  });
  $('label.placeholder').click(function(){
    $(this).hide(); 
    $('.create_post #status_message_content').focus();
  });
  $('.create_post #status_message_content').focusout(function() {
    if ($.trim($(this).val()) == '' ) {
      $("label.placeholder").show();
      $(this).css('height', '20px'); 
    }
  });
    

  $('.post_type_bar a.topic').click(function(){
    $('.topic_box').show();      
  });

  $('.post_type_bar a.photo').click(function(){
    $('.pic_box').show();      
  });

  function createTopicCallback(t_id, t_name){
    $('.create_post .topic_tag').remove();
    $('#new_status_message #topic_id').val(t_id);
    var topic_tag = $('#hide_area .topic_tag').clone();
    topic_tag.find('a.topic_name').text('话题: ' + t_name);
    topic_tag.find('a.topic_name').attr('href', "/item_topics/" + t_id);
    topic_tag.find('a.close_topic_tag').click(function(){
      topic_tag.remove();
      $('#new_status_message #topic_id').val("");
    });
    $('.topic_box a.select_topic').click();
    topic_tag.appendTo('.create_post');
    topic_tag.show();
  }

  function closeTopicBoxCallback() {
    $('#new_status_message #topic_id').val("");
  }
  
  function createPostCallBack() {
    $('.create_post .topic_tag a.close_topic_tag').click(); 
  }
