#friend_select
  .filter{ :style => "position:relative" }
    <input id="filter" type="text" style="width:100px;height:12px">
  %ul#fcbklist
    -for friend in @friends
      %li{ :id => friend.id }
        =person_image_tag( friend )
        .content{ :style=>"position: absolute;left: 60px;top: 0" }
          =friend.name
  %br
  .button.push-10
    =link_to "ok","#"
:javascript
  $(document).ready(function() {

    $('.button').button();

    $('.button' ).click(function(){
      $fcbklist.find('li[addedid]').each(function(){alert( this.id );});   
    });

    //id(ul id),width,height(element height),row(elements in row)        
    var $fcbklist = $('#fcbklist');
    var $listItems = $fcbklist.find('li');
    // id (ul id), width, height (element height), row (elements in row)        

    $('#filter').keyup(function (){
      var $this = $(this);
      
      var val = $this.val();

      /*** Show all the listItems when the filter is cleared ***/
      if (!val) {
        $this.data('lastVal', val);
        $listItems.show();
        return;
      }

      var lastVal = $this.data('lastVal');
      $this.data('lastVal', val);
      /*** If the filter hasn't changed, do nothing ***/
      if(val === lastVal) { return; }
      
      /*** Hide the results of the previous filter ***/
      $listItems.filter(':visible').hide();

      /***
        Show only the items of the current tab that match
        the filter.
      ***/
      var $tabItems;
      switch($(".view_on").attr("id").replace("view_","")) {
        case "all":
          $tabItems = $listItems;
          break;
        case "selected":
          $tabItems = $listItems.filter('[addedid]');
          break;
        case "unselected":
          $tabItems = $listItems.filter(':not([addedid])');
          break;  
      }
      $tabItems.filter(':icontains(' + val + ')').show();
    });
    
    /***
      This is a custom pseudo-selector that selects
      elements whose text contains the specified substring.
      It is case-insensitive, unlike the built-in :contains selector.
    ***/
    $.extend($.expr[':'], {
      icontains: function(elem, i, match){
        return (new RegExp(match[3], 'im')).test($(elem).text());
      }
    });
      
      $.fcbkListSelection("#fcbklist","450","50","4");
    }); 
